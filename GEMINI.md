# 專案總結 (Project Summary)

本文件提供 `Network Switcher` 命令列工具的專案高層次概述、核心特色與主要成果。

## 專案目標
本專案旨在開發一個名為 "Network Switcher" 的命令列工具，用於快速切換 Windows 作業系統的網路設定，例如網路路由、系統 Proxy 等。

## 核心特色與成果
1.  **技術棧升級**：專案已從原始的批次檔 (Batch Script) 成功遷移至更現代、穩定且易於維護的 **Python 3.x**。
2.  **開發方法論**：全面導入並遵循**測試驅動開發 (TDD)** 流程，使用 `pytest` 作為測試框架，確保程式碼品質與功能穩定性。
3.  **清晰的架構**：專案採用標準的 Python 專案結構，包含獨立的虛擬環境 (`.venv`)、主程式 (`main.py`)、設定檔 (`config.ini`) 和專門的測試目錄 (`tests/`)。
4.  **完善的文件體系**：
    *   `README.md` 提供專案總覽、快速上手指南、使用方法及開發相關資訊，並包含視覺化的 Mermaid 圖表。
    *   `CHANGELOG.md` 記錄了專案的版本變更歷史，遵循語意化版本規範。
    *   `ROADMAP.md` 作為開發路線圖，追蹤功能開發進度。
    *   `requirements.txt` 鎖定專案相依套件版本，確保環境一致性。
    *   `PROJECT_STANDARDS.md` 則是一份為未來新專案提供的通用開發規範，涵蓋了架構、程式碼、文件、測試和版本控制等各方面標準。
5.  **已實現功能**：目前已成功實作並測試了程式啟動時的系統管理員權限檢查功能。

總體而言，這個專案不僅實現了初步功能，更建立了一套高標準、易於協作與擴展的開發基礎，為未來的持續開發奠定了堅實的根基。

## 開發注意事項與潛在陷阱 (Development Notes & Pitfalls)

本區塊記錄了開發過程中可能遇到的常見問題與經驗教訓，旨在幫助開發者避免重複踩坑。

### 1. 批次檔 (Batch Script) 的陷阱
*   **`errorlevel` 的不穩定性**：在批次檔中，`errorlevel` 變數容易被後續的指令覆蓋，導致判斷失準。若需精確捕捉前一個指令的錯誤碼，應立即將其值儲存到一個臨時變數中。
*   **變數作用域與延遲擴展**：在 `for` 迴圈或 `if` 區塊中使用變數時，若未啟用 `setlocal enabledelayedexpansion` 並使用 `!variable!` 語法，可能會讀取到舊的變數值。
*   **CMD 與 PowerShell 語法差異**：Windows 終端環境可能預設為 PowerShell，其指令語法與傳統 CMD 批次檔存在顯著差異（例如指令鏈接符 `&&` vs. `;`，目錄刪除 `rmdir /s /q` vs. `Remove-Item -Recurse -Force`）。開發時需注意當前終端類型。

### 2. Python 開發環境管理
*   **虛擬環境的重要性**：務必使用 `venv` 或 `conda` 等工具建立虛擬環境，隔離專案相依性，避免全域環境污染。
*   **`requirements.txt` 的維護**：每次新增或移除套件後，應及時更新 `requirements.txt` (`pip freeze > requirements.txt`)，確保團隊成員環境一致。

### 3. 測試驅動開發 (TDD) 實踐
*   **紅燈階段的明確性**：確保測試在紅燈階段確實因預期原因失敗，而非其他意外錯誤。
*   **綠燈階段的精簡性**：在綠燈階段只撰寫最少量的程式碼以通過測試，避免過度設計。
*   **持續重構**：在綠燈後，積極重構程式碼，提升可讀性、效能和設計品質，並確保所有測試依然通過。
*   **提交前驗證**：在完成重構並確保所有測試通過後，請務必執行「提交前檢查清單」中的所有項目，確保程式碼和文件符合專案規範，然後再進行提交。

### GEMINI-CLI
*   **複雜 Git 提交訊息的處理**：當使用 `git commit -m` 提交包含多行或特殊字元（例如中文）的訊息時，在某些 Shell 環境（特別是 Windows）中可能會因轉譯問題而失敗。一個更穩健的作法是：
    1.  使用 `write_file` 工具將完整的提交訊息寫入一個暫存檔案（例如 `COMMIT_EDITMSG`）。
    2.  使用 `git commit -F <檔案路徑>` 指令從該檔案讀取訊息並執行提交。
    3.  提交成功後，記得使用正確的平台指令（Windows: `del`, Linux/macOS: `rm`）刪除該暫存檔案。
*   **Shell 指令的跨平台相容性**：在執行檔案系統操作等 Shell 指令時，需注意其平台特定性。例如，在 Windows (`win32`) 上刪除檔案的指令是 `del`，而在 Unix/Linux/macOS 上則是 `rm`。在執行前應先確認當前作業系統環境，以選用正確的指令。

## 與 LLM 協作提示 (Tips for Collaborating with LLMs)

與大型語言模型 (LLM) 協作開發時，以下提示能幫助您更有效率地引導 LLM：

1.  **提供充足上下文**：
    *   **專案總覽**：在開始新任務前，先提供 `GEMINI.md` 的內容，讓 LLM 了解專案的整體目標、技術棧和核心原則。
    *   **相關檔案內容**：當要求 LLM 修改或新增程式碼時，提供相關檔案的完整內容，避免 LLM 產生不符合現有風格或邏輯的程式碼。
    *   **錯誤訊息與日誌**：除錯時，提供完整的錯誤堆疊追蹤 (stack trace) 和相關日誌，幫助 LLM 快速定位問題。

2.  **明確指令與期望輸出**：
    *   **具體化任務**：避免模糊的指令，例如「請幫我寫程式」。應具體說明「請在 `main.py` 中新增一個 `load_config` 函式，它應該讀取 `config.ini` 並回傳一個字典」。
    *   **指定格式**：明確要求輸出格式，例如「請以 Markdown 程式碼區塊提供 Python 程式碼」、「請以表格形式總結」。
    *   **指定語言**：始終要求 LLM 使用「台灣繁體中文及其慣用語法」進行溝通和文件撰寫。

3.  **分階段引導**：
    *   將複雜的任務拆解成多個小步驟，每次只要求 LLM 完成一個步驟。例如：先要求撰寫測試，確認紅燈後再要求撰寫程式碼，確認綠燈後再要求重構。
    *   這有助於控制 LLM 的輸出，並在每個階段進行驗證。

4.  **利用工具能力**：
    *   明確指示 LLM 使用其可用的工具，例如 `read_file`、`write_to_file`、`execute_command`。例如：「請使用 `read_file` 讀取 `config.ini` 的內容」。
    *   當 LLM 提出需要執行指令時，若您同意，請明確指示其執行。

遵循這些提示，將能大幅提升您與 LLM 協作的效率與成果。

## 提交前檢查清單 (Pre-commit Checklist)

在每次提交程式碼之前，請務必遵循以下檢查清單，以確保程式碼品質與專案規範：

1.  **檔案狀態確認**：
    *   所有相關的修改、新增、刪除檔案是否都已正確地加入暫存區 (`git add`)？
    *   使用 `git status` 確認工作區是乾淨的，或只包含預期外的變更。

2.  **程式碼品質與功能**：
    *   所有功能是否已完整實作並通過測試？
    *   是否已執行專案的測試（例如 `pytest`），且所有測試都已通過？
    *   **是否已生成最新的 HTML 測試報告 (`pytest --html=test_report.html`)？**
    *   程式碼是否符合 PEP 8 風格指南？（若有自動格式化工具，請確保已執行）
    *   是否已處理所有已知的錯誤和邊界情況？

3.  **文件更新**：
    *   `CHANGELOG.md` 是否已更新，並遵循語意化版本規範？
    *   `ROADMAP.md` 是否已更新，以反映功能的進度？
    *   `README.md` 或其他相關文件是否已更新，以反映任何新的功能、配置或使用說明？
    *   所有文件是否都使用「台灣繁體中文及其慣用語法」？

4.  **提交訊息**：
    *   提交訊息是否遵循 Conventional Commits 規範（例如 `feat:`, `fix:`, `docs:` 等）？
    *   提交訊息是否使用「台灣繁體中文及其慣用語法」？
    *   如果提交訊息是多行或包含特殊字元，是否已將其寫入暫存檔案（例如 `COMMIT_EDITMSG`），並準備使用 `git commit -F <檔案路徑>` 進行提交？

5.  **環境與相依性**：
    *   如果新增或移除了任何套件，`requirements.txt` 是否已更新 (`pip freeze > requirements.txt`)？
    *   虛擬環境是否已正確啟用？